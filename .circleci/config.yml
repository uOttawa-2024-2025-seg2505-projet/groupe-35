version: 2.1

executors:
  android:
    docker:
      - image: circleci/android:api-30  # Utiliser une image CircleCI avec Android SDK.
    working_directory: ~/project

jobs:
  # Job pour exécuter les tests unitaires
  test-unit:
    executor: android
    steps:
      - checkout
      - run:
          name: Configure SDK
          command: sdkmanager "platforms;android-30" "build-tools;30.0.3"
      - run:
          name: Run Unit Tests
          command: ./gradlew testDebugUnitTest

  # Job pour exécuter les tests d'instrumentation (facultatif)
  test-instrumentation:
    executor: android
    steps:
      - checkout
      - run:
          name: Install SDK Tools
          command: sdkmanager "platforms;android-30" "build-tools;30.0.3"
      - run:
          name: Run Instrumentation Tests
          command: ./gradlew connectedDebugAndroidTest

workflows:
  version: 2
  test-workflow:
    jobs:
      - test-unit
